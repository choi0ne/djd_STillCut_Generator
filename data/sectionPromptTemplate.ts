/**
 * 섹션 일러스트 프롬프트 템플릿
 * 
 * ✅ styleLibrary.ts의 모든 17개 스타일에 대한 프롬프트 블록 정의
 * ✅ 스타일 선택 → 해당 블록으로 교체
 * ✅ 6개 섹션 모두 동일한 구조
 * ✅ 한글 프롬프트 통일
 */

// =============================================================================
// 🎨 스타일별 프롬프트 블록 (styleLibrary.ts의 모든 스타일 포함)
// =============================================================================

export const STYLE_PROMPT_BLOCKS: Record<string, string> = {
    // ----- 1. 아이소메트릭 인포그래픽 -----
    'isometric-infographic': `
[그림체]
- 아이소메트릭(등각투영) 3D 벡터 일러스트
- 45도 각도에서 본 미니어처 3D 오브젝트들
- 플랫한 면 + 미니멀한 한 방향 그림자

[구성]
- 각 오브젝트는 작은 플랫폼 위에 배치
- 오브젝트들이 네트워크형으로 연결

[색상]
- 밝고 선명한 컬러 아이콘들 (빨강, 노랑, 초록, 파랑)

[배경]
- 흰색 또는 연한 회색
`,

    // ----- 2. 인포그래픽 차트 -----
    'infographic-chart': `
[그림체]
- 플랫 벡터 인포그래픽 스타일
- 그림자 없음, 깔끔한 선

[구성]
- 컬러풀한 막대 그래프/차트
- 남녀 실루엣 아이콘으로 인구/성별 표현
- 데이터 라벨이 차트 옆에 배치

[색상]
- 카테고리별 색상 구분 (그라데이션 가능)
- 밝고 친근한 데이터 시각화

[배경]
- 흰색 또는 연한 크림색
`,

    // ----- 3. 공감 캐릭터 -----
    'empathetic-character': `
[그림체]
- 플랫 일러스트 캐릭터 (말풍선 없음)
- 깔끔한 벡터 스타일, 그림자 없음
- 굵은 검정 외곽선(2-3px), 단색 플랫 컬러 채움
- 단순화된 얼굴 (큰 눈, 심플한 표정)

[구성]
- 증상 표현 포즈 (머리 짚기, 배 감싸기 등)
- 말풍선/텍스트 없음, 이미지로만 감정 전달

[색상]
- 파스텔 또는 따뜻한 컬러 팔레트

[배경]
- 단색 파스텔 또는 크림색
`,

    // ----- 4. 약재 스케치 -----
    'herbal-sketch': `
[그림체]
- 빈티지 잉크 드로잉 스타일
- 가는 펜촉으로 그린 듯한 세밀한 선화
- 해칭(빗금)과 크로스해칭으로 음영 표현

[구성]
- 약병, 한약재(인삼, 감초), 저울, 허브 식물
- 19세기 약학 도감 느낌 배치

[색상]
- 흑백 기반 + 부분 수채화 컬러 (녹색 잎, 갈색 뿌리)

[배경]
- 오프화이트/크림색 종이 질감
`,

    // ----- 5. 공감 컷툰 -----
    'empathetic-cutoon': `
[그림체]
- 플랫 일러스트 컷툰 (말풍선 있음)
- 깔끔한 벡터 스타일, 그림자 없음
- 굵은 검정 외곽선, 단색 플랫 컬러 채움

[구성]
- 캐릭터가 화면 좌측 2/3 차지
- 우측 상단에 말풍선/생각풍선
- 둥근 고딕체로 2-3줄 짧은 대사

[색상]
- 파스텔 톤 의상

[배경]
- 파스텔 또는 크림색
`,

    // ----- 6. 예술적 썸네일 -----
    'artistic-thumbnail': `
[그림체]
- 미니멀 반추상 일러스트
- 깔끔한 벡터 또는 부드러운 텍스처
- 단순화된 형태, 과도한 디테일 없이

[구성]
- 주제를 상징하는 핵심 시각 요소 1-2개
- 여백을 충분히 살린 미니멀 구도

[색상]
- 제한된 2-3색 팔레트

[배경]
- 단색 또는 부드러운 그라데이션
`,

    // ----- 7. 블로그 썸네일 -----
    'blog-thumbnail': `
[그림체]
- 세로형 블로그 썸네일 (2:3 비율, 800x1200px)
- 페이퍼크래프트 일러스트 (레이어드 종이 컷아웃)
- 손으로 만든 듯한 핸드메이드 느낌
- 부드러운 그림자로 입체감

[구성]
- 상단 75%: 메인 비주얼 (페이퍼크래프트 일러스트)
- 하단 25%: 제목 텍스트 영역
- 도현체 스타일 굵은 한글 고딕체

[색상]
- 따뜻한 파스텔 컬러 (연한 핑크, 민트, 베이지)

[배경]
- 연한 크림색 (#F5F0E8)
`,

    // ----- 8. 손그림 다이어그램 -----
    'hand-drawn-diagram': `
[그림체]
- 손그림 느낌의 다이어그램
- 검정 잉크 펜으로 그린 듯한 스케치 라인
- 선 굵기 1-2px, 약간의 손떨림 텍스처

[구성]
- 둥근 사각형 박스들이 화살표로 연결
- 각 박스 안에 심플한 아이콘 (구름, 저울, 위장 등)

[색상]
- 흑백 기반 또는 단색 라인

[배경]
- 노트북/메모장 위에 그린 느낌
`,

    // ----- 9. 의학 일러스트레이션 -----
    'medical-illustration': `
[그림체]
- 부드러운 수채화/파스텔 톤 해부학적 일러스트
- 장기를 교육적이면서 따뜻하게 묘사
- 가는 검정 외곽선 + 부드러운 색상

[구성]
- 좌우 비교 구조 권장 (건강 vs 질환)
- 화살표로 설명 라벨 연결

[색상]
- 베이지, 살색, 연핑크

[배경]
- 흰색 또는 연한 크림색
`,

    // ----- 10. 개념적 은유 -----
    'conceptual-metaphor': `
[그림체]
- 미니멀 장기 실루엣 + 수묵화 텍스처 (동양적 느낌)
- 장기(위장, 폐, 뇌 등)를 검정 외곽선(2-3px)으로 단순하게 드로잉
- 장기 내부에 수묵화/먹 번짐 텍스처로 상태 표현
- 동양화 특유의 농담(濃淡) 표현

[구성]
- 장기 외부는 비워두거나 최소한의 요소만
- 하단에 굵은 명조체 한글 제목

[색상]
- 흑백 + 부분 색상 (담적→먹색, 염증→붉은 번짐)

[배경]
- 한지 질감의 크림색/오프화이트 (#F5F0E8)
`,

    // ----- 11. 2D 스텝 다이어그램 -----
    '2d-step-diagram': `
[그림체]
- 깔끔한 2D 벡터 인포그래픽
- 플랫 디자인, 그림자 없음

[구성]
- 둥근 사각형/원형 블록에 숫자 또는 아이콘
- 화살표로 스텝 간 연결 (3-5개 스텝)

[색상]
- 각 블록에 다른 파스텔 색상

[배경]
- 흰색 또는 연한 회색
`,

    // ----- 12. 페이퍼크래프트 일러스트 -----
    'papercraft-illustration': `
[그림체]
- 레이어드 페이퍼크래프트 3D 일러스트
- 종이를 오려 붙인 듯한 질감과 층
- 부드러운 그림자로 입체감

[구성]
- 장기/신체를 귀엽고 친근하게 단순화
- 핸드메이드 느낌

[색상]
- 따뜻한 파스텔 (연핑크, 민트, 베이지)

[배경]
- 밝은 크림색 또는 흰색
`,

    // ----- 13. 미니멀 웰니스 포토 -----
    'minimal-wellness-photo': `
[그림체]
- 하이키 미니멀리스트 사진 스타일
- 자연광, 밝고 깔끔한 톤

[구성]
- 허브차, 약재, 건강 음식 배치
- 텍스트/사람 없음

[색상]
- 자연스러운 톤, 세련된 웰니스 느낌

[배경]
- 텍스처 있는 밝은 회색 표면
`,

    // ----- 14. 연속 한 줄 드로잉 -----
    'continuous-line-drawing': `
[그림체]
- 연속적인 한 줄 드로잉
- 선이 끊기지 않고 전체 형태 표현
- 검정색 얇은 선 (1-2px)

[구성]
- 인체 측면 프로필 + 내부 장기/뇌
- 채색 없이 선만으로 표현

[색상]
- 흑백 (검정 선)

[배경]
- 흰색 또는 오프화이트
`,

    // ----- 15. 개념적 스케치 -----
    'conceptual-sketch': `
[그림체]
- 연필/목탄 스케치 스타일
- 손그림 느낌의 거친 선

[구성]
- 단순화된 스틱맨 또는 간단한 인물
- 추상적 개념을 시각적 은유로 (갈림길, 무거운 짐 등)

[색상]
- 모노크롬 (흑백 또는 세피아)

[배경]
- 오프화이트 종이 질감
`,

    // ----- 16. 텍스처 디지털 페인팅 -----
    'textured-digital-painting': `
[그림체]
- 파스텔/색연필 느낌의 디지털 페인팅
- 고운 입자의 종이 텍스처 오버레이
- 거친 엣지 없이 부드럽게

[구성]
- 부드러운 포커스
- 은은하고 감성적인 분위기

[색상]
- 따뜻한 파스텔 톤

[배경]
- 아날로그적인 질감의 밝은 톤
`,

    // ----- 17. 정밀 의학도 -----
    'precision-medical': `
[그림체]
- 의학 교과서 스타일 정밀 해부학
- Netter's Atlas 참고
- 정확한 해부학적 비율, 섬세한 명암

[구성]
- 화살표 + 리더 라인으로 라벨 연결
- 전문적이고 교육적인 임상 수준

[색상]
- 색상 코딩: 동맥(빨강), 정맥(파랑)

[배경]
- 흰색 또는 연한 크림색
`,

    // ----- 18. 섹션 일러스트 -----
    'section-illustration': `
[그림체]
- 파스텔 배너 스타일 섹션 일러스트
- 플랫 벡터 일러스트, 그림자 없음
- 굵은 검정 외곽선(2-3px), 단색 플랫 컬러 채움
- 귀여운 캐릭터 (큰 머리, 심플한 표정, 동그란 눈)

[구성]
- 좌측: 캐릭터가 증상/감정을 표현하는 포즈
- 우측: 말풍선에 핵심 메시지 (2-3단어)
- 캐릭터 크기는 화면의 40-50%

[색상]
- 파스텔 그라데이션 (핑크→연보라, 민트→하늘색)
- 캐릭터: 따뜻한 피부톤, 파스텔 의상

[배경]
- 부드러운 파스텔 그라데이션
`,

    // ----- 19. 플랫 일러스트 -----
    'flat-illustration': `
[그림체]
- 깔끔한 플랫 벡터 일러스트
- 외곽선 없이 단색 면으로만 구성
- 그라데이션/그림자 없음
- 매우 단순화된 얼굴 (점 눈, 코 없음, 곡선 미소)

[구성]
- Adobe Stock 스타일 배치
- 심플한 구도

[색상]
- 파스텔 의상 (핑크, 민트, 연보라)

[배경]
- 깔끔한 흰색
`,

    // ----- 20. 포스터 (세로형) -----
    'poster': `
[그림체]
- 세로형 홍보 포스터 스타일
- 벡터 실루엣 일러스트

[구성]
- 3단 구조: 상단 키워드 / 중앙 비주얼 / 하단 메시지
- 굵은 세리프체 또는 도현체 제목

[색상]
- 밝은 청록색 포인트

[배경]
- 깊은 네이비 그라데이션
`,

    // ----- 21. 운동법 가이드 -----
    'exercise-guide': `
[그림체]
- 심플한 라인 드로잉 운동 가이드
- 깔끔한 검정 외곽선 인체

[구성]
- 가로 3단 배열 (시작→중간→완료)
- 동작 방향을 청록색 화살표로 표시

[색상]
- 민트/청록색 상의 + 검정 하의

[배경]
- 흰색 또는 연한 회색
`,

    // ----- 22. 블로그템플릿_미니멀 -----
    'blog-thumbnail-minimal': `
[그림체]
- 세로형 블로그 썸네일 (2:3 비율, 800x1200px)
- 미니멀 의학 라인아트 스타일
- 가는 검정 외곽선(1-2px)으로 장기/인체 부위를 심플하게 드로잉
- 채색 없이 선만으로 형태 표현
- 장기 주변에 파란색/청록색 스플래터, 연기, 입자 효과
- 수채화 번짐 또는 잉크 스플래시 느낌

[구성]
- 장기(위장, 폐, 뇌 등) 또는 인체 부분이 중앙에 배치
- 스플래터/연기 효과가 장기 주변을 감싸거나 퍼짐
- 하단에 한글 제목 배치 (나눔명조 ExtraBold)
- 중요 텍스트는 중앙에 배치 (다양한 비율로 잘려도 보이도록)

[색상]
- 2-3색 제한 (검정 라인 + 파란색/청록색 + 선택적 주황/베이지)
- 제목: 검정색(#333333)

[배경]
- 미니멀한 크림색/오프화이트 (#F5F0E8)
`,

    // ----- 23. 플로잉 스월 일러스트 -----
    'flowing-swirl-illustration': `
[그림체]
- 유기적 흐름 라인아트 스타일
- 한 점에서 시작해 자연스럽게 퍼져나가는 곡선들
- 소용돌이, 물방울, 스플래터 효과
- 보타니컬 요소(나뭇잎, 식물)와 추상적 곡선 결합
- 가는 선에서 굵은 선으로 변화하는 다이나믹한 표현

[구성]
- 좌측 또는 중앙 하단에서 시작점
- 우측 또는 상단으로 확산
- 하단에 한글 제목

[색상]
- 2-3색 제한 (검정, 녹색/청록, 파랑)

[배경]
- 미니멀한 크림/오프화이트
`,

    // ----- 24. 실루엣 해부학 -----
    'silhouette-anatomy': `
[그림체]
- 개념적 실루엣 해부학 스타일
- 인체 측면 또는 정면 실루엣
- 단색 그라데이션으로 채움
- 실루엣 내부에 장기/기관 표현 (폐, 기관지, 위, 심장)
- 입/코에서 입자, 스플래터, 연기 효과로 증상 표현

[구성]
- 실루엣이 화면 중앙에 배치
- 하단에 한글 제목과 부제

[색상]
- 파란색, 청록색 계열

[배경]
- 미니멀한 크림/오프화이트
`,

    // ----- 25. 의료 스캔 비주얼 -----
    'medical-scan-visual': `
[그림체]
- 의료 스캔 이미지 스타일 (CT/MRI/X-ray)
- 원형 또는 타원형 스캔 이미지 프레임
- 진단 포인트에 화살표 또는 마커 표시
- 나침반, 돋보기 등 진단 아이콘 배치 가능

[구성]
- 스캔 이미지가 중앙 또는 상단에 배치
- 하단에 한글 제목과 설명

[색상]
- 회색/청록색 톤의 스캔 이미지

[배경]
- 다크 그린/네이비 또는 밝은 크림
`
};

// =============================================================================
// 섹션 타이틀 매핑
// =============================================================================

export const SECTION_TITLE_KOREAN: Record<string, string> = {
    'Answer First': '핵심 결론',
    'Action': '즉각 실천',
    'Warning': '위험 신호',
    'The Why': '상세 원인',
    'Proof': '사례와 근거',
    'Closing': '마무리'
};

// =============================================================================
// 팔레트 색상 정의
// =============================================================================

export const PALETTE_COLORS: Record<string, { primary: string; secondary: string; accent: string; background: string }> = {
    'medical': {
        primary: '#5C7AEA (차분한 파랑)',
        secondary: '#E8EDF5 (연한 회색빛 파랑)',
        accent: '#3D5AF1 (진한 파랑)',
        background: '#F8FAFF (밝은 흰색)'
    },
    'calm': {
        primary: '#7CB8B6 (차분한 청록)',
        secondary: '#E8F4F3 (연한 민트)',
        accent: '#5BA8A6 (진한 청록)',
        background: '#FAFEFE (부드러운 흰색)'
    },
    'warm': {
        primary: '#E8A87C (따뜻한 살구색)',
        secondary: '#FFF4EC (연한 베이지)',
        accent: '#D4845C (진한 테라코타)',
        background: '#FFFBF8 (크림색)'
    }
};

// =============================================================================
// 📐 공통 사이즈 블록 (레고 교체용)
// =============================================================================

// 가로형: 블로그 본문용 (대부분의 스타일)
export const SIZE_BLOCK = `【사이즈】
1024x558px, 가로형 1.83:1 비율
블로그 본문 최적화 가로 배너`;

// 세로형: 블로그 썸네일/포스터용
export const SIZE_BLOCK_VERTICAL = `【사이즈】
800x1200px, 세로형 2:3 비율
블로그 썸네일/포스터 최적화`;

// 세로형 스타일 ID 목록
const VERTICAL_STYLES = ['blog-thumbnail', 'blog-thumbnail-minimal', 'poster'];

// =============================================================================
// 프롬프트 생성 함수
// =============================================================================

export interface SectionPromptInput {
    sectionNumber: number;
    sectionTitle: string;
    imageSceneDescription: string;  // Stage 7에서 생성된 장면 묘사
    recommendedPalette: 'medical' | 'calm' | 'warm';
}

/**
 * 🎨 섹션 일러스트 프롬프트 생성 (블록화된 레고 구조)
 * 
 * 블록 순서: 【사이즈】→【섹션】→【스타일】→【색상 팔레트】→【인물】→【장면 묘사】→【필수 제외】
 * 
 * @param section - 섹션 정보 (Stage 7에서 생성)
 * @param styleId - 선택된 스타일 ID (17개 중 1개)
 * @returns 완성된 블록화 프롬프트
 */
export function generateSectionPrompt(
    section: SectionPromptInput,
    styleId: string
): string {
    const titleKorean = SECTION_TITLE_KOREAN[section.sectionTitle] || section.sectionTitle;
    const styleBlock = STYLE_PROMPT_BLOCKS[styleId] || STYLE_PROMPT_BLOCKS['section-illustration'];
    const palette = PALETTE_COLORS[section.recommendedPalette] || PALETTE_COLORS['medical'];

    // 🔴 세로형 스타일은 세로형 사이즈 블록 적용
    const sizeBlock = VERTICAL_STYLES.includes(styleId) ? SIZE_BLOCK_VERTICAL : SIZE_BLOCK;

    // Proof 섹션은 캐릭터 없음
    const characterBlock = section.sectionTitle === 'Proof'
        ? `【인물】
없음 - 데이터/차트 중심 섹션`
        : `【인물】
30대 성인, 캐주얼 복장
(의사/한의사 절대 금지)`;

    return `${sizeBlock}

【섹션 ${section.sectionNumber}】 ${titleKorean}

【스타일】
${styleBlock.trim()}

【색상 팔레트】
- 주 색상: ${palette.primary}
- 보조 색상: ${palette.secondary}
- 강조 색상: ${palette.accent}
- 배경 색상: ${palette.background}

${characterBlock}

【장면 묘사】
${section.imageSceneDescription}

【필수 제외】
의사, 한의사, 의료진, 흰 가운, 청진기, 주사기, 병원/진료실 배경`;
}

/**
 * 6개 섹션 프롬프트 일괄 생성
 */
export function generateAllSectionPrompts(
    sections: SectionPromptInput[],
    styleId: string
): string[] {
    return sections.map(section => generateSectionPrompt(section, styleId));
}
